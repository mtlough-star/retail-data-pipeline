{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-11T14:28:18.909799Z", "invocation_id": "37beb588-ee79-4dc0-b2f9-a7db4e678ce2", "invocation_started_at": "2026-01-11T14:28:15.755504Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.303571Z", "completed_at": "2026-01-11T14:28:18.309713Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.309713Z", "completed_at": "2026-01-11T14:28:18.309713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006142616271972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail_analytics.stg_online_retail", "compiled": true, "compiled_code": "/*\nStaging model for Online Retail data\nThis model cleans and standardizes raw data:\n- Filters out cancelled orders (InvoiceNo starting with 'C')\n- Removes invalid quantities and prices\n- Calculates line total\n- Standardizes data types\n*/\n\nWITH source AS (\n    SELECT *\n    FROM RETAIL_DW.RAW.online_retail\n),\n\ncleaned AS (\n    SELECT\n        -- Primary identifiers\n        InvoiceNo AS invoice_number,\n        StockCode AS stock_code,\n        CustomerID AS customer_id,\n        \n        -- Product information\n        TRIM(Description) AS product_description,\n        \n        -- Transaction details\n        Quantity AS quantity,\n        UnitPrice AS unit_price,\n        \n        -- Calculate line total (quantity * unit price)\n        Quantity * UnitPrice AS line_total,\n        \n        -- Date information\n        InvoiceDate AS invoice_date,\n        DATE_TRUNC('day', InvoiceDate) AS invoice_date_day,\n        DATE_TRUNC('month', InvoiceDate) AS invoice_month,\n        DATE_TRUNC('year', InvoiceDate) AS invoice_year,\n        \n        -- Geographic information\n        UPPER(TRIM(Country)) AS country,\n        \n        -- Metadata\n        loaded_at\n        \n    FROM source\n    \n    WHERE 1=1\n        -- Filter out cancelled orders (invoices starting with 'C')\n        AND LEFT(InvoiceNo, 1) != 'C'\n        \n        -- Filter out invalid quantities (must be positive)\n        AND Quantity > 0\n        \n        -- Filter out invalid prices (must be positive)\n        AND UnitPrice > 0\n        \n        -- Filter out records with unknown customers for customer analysis\n        AND CustomerID != 'UNKNOWN'\n        \n        -- Filter out invalid dates\n        AND InvoiceDate IS NOT NULL\n)\n\nSELECT * FROM cleaned", "relation_name": "RETAIL_DW.STAGING_staging.stg_online_retail", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.313921Z", "completed_at": "2026-01-11T14:28:18.345003Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.345003Z", "completed_at": "2026-01-11T14:28:18.345003Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0310823917388916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail_analytics.dim_customers", "compiled": true, "compiled_code": "/*\nCustomer Dimension Table\nContains one row per unique customer with aggregated metrics\nThis is a Type 1 SCD (Slowly Changing Dimension)\n*/\n\nWITH customer_orders AS (\n    SELECT\n        customer_id,\n        MAX(country) AS country,\n        MIN(invoice_date) AS first_order_date,\n        MAX(invoice_date) AS last_order_date,\n        COUNT(DISTINCT invoice_number) AS total_orders,\n        COUNT(*) AS total_line_items,\n        SUM(quantity) AS total_items_purchased,\n        SUM(line_total) AS total_revenue,\n        AVG(line_total) AS avg_line_value,\n        MAX(line_total) AS max_line_value\n    FROM RETAIL_DW.STAGING_staging.stg_online_retail\n    GROUP BY customer_id\n),\n\ncustomer_segments AS (\n    SELECT\n        *,\n        -- Customer lifetime value segment\n        CASE \n            WHEN total_revenue >= 5000 THEN 'High Value'\n            WHEN total_revenue >= 1000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS customer_segment,\n        \n        -- Order frequency segment\n        CASE \n            WHEN total_orders >= 20 THEN 'Frequent'\n            WHEN total_orders >= 5 THEN 'Regular'\n            ELSE 'Occasional'\n        END AS frequency_segment,\n        \n        -- Calculate days between first and last order\n        DATEDIFF('day', first_order_date, last_order_date) AS customer_lifetime_days,\n        \n        -- Calculate average days between orders\n        CASE \n            WHEN total_orders > 1 \n            THEN DATEDIFF('day', first_order_date, last_order_date) / (total_orders - 1)\n            ELSE NULL\n        END AS avg_days_between_orders\n        \n    FROM customer_orders\n)\n\nSELECT\n    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS customer_key,\n    customer_id,\n    country,\n    first_order_date,\n    last_order_date,\n    customer_lifetime_days,\n    total_orders,\n    total_line_items,\n    total_items_purchased,\n    ROUND(total_revenue, 2) AS total_revenue,\n    ROUND(avg_line_value, 2) AS avg_line_value,\n    ROUND(max_line_value, 2) AS max_line_value,\n    ROUND(avg_days_between_orders, 1) AS avg_days_between_orders,\n    customer_segment,\n    frequency_segment,\n    CURRENT_TIMESTAMP() AS dw_created_at,\n    CURRENT_TIMESTAMP() AS dw_updated_at\nFROM customer_segments", "relation_name": "RETAIL_DW.STAGING_analytics.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.325091Z", "completed_at": "2026-01-11T14:28:18.345003Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.345003Z", "completed_at": "2026-01-11T14:28:18.345003Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0310823917388916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail_analytics.dim_products", "compiled": true, "compiled_code": "/*\nProduct Dimension Table\nContains one row per unique product with sales metrics\n*/\n\nWITH product_sales AS (\n    SELECT\n        stock_code,\n        -- Use the most recent product description (in case it changed)\n        MAX(product_description) AS product_description,\n        \n        -- Aggregated sales metrics\n        COUNT(DISTINCT invoice_number) AS times_ordered,\n        COUNT(DISTINCT customer_id) AS unique_customers,\n        SUM(quantity) AS total_quantity_sold,\n        SUM(line_total) AS total_revenue,\n        AVG(unit_price) AS avg_unit_price,\n        MIN(unit_price) AS min_unit_price,\n        MAX(unit_price) AS max_unit_price,\n        \n        -- Date information\n        MIN(invoice_date) AS first_sold_date,\n        MAX(invoice_date) AS last_sold_date\n        \n    FROM RETAIL_DW.STAGING_staging.stg_online_retail\n    GROUP BY stock_code\n),\n\nproduct_categories AS (\n    SELECT\n        *,\n        -- Categorize products by revenue\n        CASE \n            WHEN total_revenue >= 10000 THEN 'Top Seller'\n            WHEN total_revenue >= 1000 THEN 'Popular'\n            WHEN total_revenue >= 100 THEN 'Regular'\n            ELSE 'Low Volume'\n        END AS product_category,\n        \n        -- Price variance indicator\n        CASE \n            WHEN max_unit_price - min_unit_price > avg_unit_price * 0.2 \n            THEN 'High Variance'\n            ELSE 'Stable Pricing'\n        END AS price_stability,\n        \n        -- Calculate days product has been available\n        DATEDIFF('day', first_sold_date, last_sold_date) AS days_on_market\n        \n    FROM product_sales\n)\n\nSELECT\n    md5(cast(coalesce(cast(stock_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS product_key,\n    stock_code,\n    product_description,\n    times_ordered,\n    unique_customers,\n    total_quantity_sold,\n    ROUND(total_revenue, 2) AS total_revenue,\n    ROUND(avg_unit_price, 2) AS avg_unit_price,\n    ROUND(min_unit_price, 2) AS min_unit_price,\n    ROUND(max_unit_price, 2) AS max_unit_price,\n    first_sold_date,\n    last_sold_date,\n    days_on_market,\n    product_category,\n    price_stability,\n    CURRENT_TIMESTAMP() AS dw_created_at,\n    CURRENT_TIMESTAMP() AS dw_updated_at\nFROM product_categories", "relation_name": "RETAIL_DW.STAGING_analytics.dim_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.325091Z", "completed_at": "2026-01-11T14:28:18.345003Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.345003Z", "completed_at": "2026-01-11T14:28:18.345003Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0310823917388916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.retail_analytics.fact_sales", "compiled": true, "compiled_code": "/*\nSales Fact Table\nGrain: One row per invoice line item\nLinks to customer and product dimensions\n*/\n\nWITH sales_with_row_numbers AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (ORDER BY invoice_date, invoice_number, stock_code) AS row_num\n    FROM RETAIL_DW.STAGING_staging.stg_online_retail\n),\n\nsales_with_keys AS (\n    SELECT\n        -- Generate surrogate key for fact table including row number for uniqueness\n        md5(cast(coalesce(cast(invoice_number as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stock_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invoice_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(row_num as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sales_key,\n        \n        -- Foreign keys to dimensions\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS customer_key,\n        md5(cast(coalesce(cast(stock_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS product_key,\n        \n        -- Degenerate dimensions (attributes that don't belong in dimension tables)\n        invoice_number,\n        \n        -- Metrics (measures)\n        quantity,\n        unit_price,\n        line_total,\n        \n        -- Date dimension attributes\n        invoice_date,\n        invoice_date_day,\n        invoice_month,\n        invoice_year,\n        DAYNAME(invoice_date) AS day_of_week,\n        DAYOFWEEK(invoice_date) AS day_of_week_number,\n        QUARTER(invoice_date) AS quarter,\n        \n        -- Geographic dimension\n        country,\n        \n        -- Metadata\n        loaded_at\n        \n    FROM sales_with_row_numbers\n)\n\nSELECT\n    sales_key,\n    customer_key,\n    product_key,\n    invoice_number,\n    quantity,\n    ROUND(unit_price, 2) AS unit_price,\n    ROUND(line_total, 2) AS line_total,\n    invoice_date,\n    invoice_date_day,\n    invoice_month,\n    invoice_year,\n    day_of_week,\n    day_of_week_number,\n    quarter,\n    country,\n    loaded_at,\n    CURRENT_TIMESTAMP() AS dw_created_at\nFROM sales_with_keys", "relation_name": "RETAIL_DW.STAGING_analytics.fact_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.334749Z", "completed_at": "2026-01-11T14:28:18.345003Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.345003Z", "completed_at": "2026-01-11T14:28:18.345003Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0310823917388916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_stg_online_retail_customer_id.5c897667c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RETAIL_DW.STAGING_staging.stg_online_retail\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.356367Z", "completed_at": "2026-01-11T14:28:18.372077Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.376471Z", "completed_at": "2026-01-11T14:28:18.376471Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020104169845581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_stg_online_retail_invoice_date.52261f111c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_date\nfrom RETAIL_DW.STAGING_staging.stg_online_retail\nwhere invoice_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.356367Z", "completed_at": "2026-01-11T14:28:18.376471Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.376471Z", "completed_at": "2026-01-11T14:28:18.376471Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020104169845581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_stg_online_retail_invoice_number.e999c8d36c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_number\nfrom RETAIL_DW.STAGING_staging.stg_online_retail\nwhere invoice_number is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.366314Z", "completed_at": "2026-01-11T14:28:18.376471Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.376471Z", "completed_at": "2026-01-11T14:28:18.376471Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020104169845581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_stg_online_retail_line_total.e3b6bf483e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect line_total\nfrom RETAIL_DW.STAGING_staging.stg_online_retail\nwhere line_total is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.372077Z", "completed_at": "2026-01-11T14:28:18.376471Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.376471Z", "completed_at": "2026-01-11T14:28:18.376471Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020104169845581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_stg_online_retail_quantity.c5f1dc3a19", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom RETAIL_DW.STAGING_staging.stg_online_retail\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.386861Z", "completed_at": "2026-01-11T14:28:18.403371Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.407374Z", "completed_at": "2026-01-11T14:28:18.407374Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030902862548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_stg_online_retail_stock_code.6becceee4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stock_code\nfrom RETAIL_DW.STAGING_staging.stg_online_retail\nwhere stock_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.387463Z", "completed_at": "2026-01-11T14:28:18.407374Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.407374Z", "completed_at": "2026-01-11T14:28:18.407374Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030902862548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_stg_online_retail_unit_price.b1bd0f03ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unit_price\nfrom RETAIL_DW.STAGING_staging.stg_online_retail\nwhere unit_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.387463Z", "completed_at": "2026-01-11T14:28:18.407374Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.407374Z", "completed_at": "2026-01-11T14:28:18.407374Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030902862548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.accepted_values_dim_customers_customer_segment__High_Value__Medium_Value__Low_Value.1552de3c50", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from RETAIL_DW.STAGING_analytics.dim_customers\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'High Value','Medium Value','Low Value'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.403371Z", "completed_at": "2026-01-11T14:28:18.407374Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.407374Z", "completed_at": "2026-01-11T14:28:18.407374Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030902862548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RETAIL_DW.STAGING_analytics.dim_customers\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.407374Z", "completed_at": "2026-01-11T14:28:18.424617Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.435494Z", "completed_at": "2026-01-11T14:28:18.435494Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.028120040893554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_dim_customers_customer_key.4bebfb3411", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_key\nfrom RETAIL_DW.STAGING_analytics.dim_customers\nwhere customer_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.419597Z", "completed_at": "2026-01-11T14:28:18.435494Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.438514Z", "completed_at": "2026-01-11T14:28:18.438514Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.031139850616455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_dim_customers_total_revenue.a988ec07e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue\nfrom RETAIL_DW.STAGING_analytics.dim_customers\nwhere total_revenue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.426626Z", "completed_at": "2026-01-11T14:28:18.435494Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.438514Z", "completed_at": "2026-01-11T14:28:18.438514Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.031139850616455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RETAIL_DW.STAGING_analytics.dim_customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.428133Z", "completed_at": "2026-01-11T14:28:18.435494Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.440029Z", "completed_at": "2026-01-11T14:28:18.440029Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0204317569732666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.unique_dim_customers_customer_key.ad8156656e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_key as unique_field,\n    count(*) as n_records\n\nfrom RETAIL_DW.STAGING_analytics.dim_customers\nwhere customer_key is not null\ngroup by customer_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.440029Z", "completed_at": "2026-01-11T14:28:18.449195Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.451583Z", "completed_at": "2026-01-11T14:28:18.451583Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013069629669189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_dim_products_product_key.a98dfddb9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_key\nfrom RETAIL_DW.STAGING_analytics.dim_products\nwhere product_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.449195Z", "completed_at": "2026-01-11T14:28:18.459555Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.466586Z", "completed_at": "2026-01-11T14:28:18.466586Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026557445526123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_dim_products_stock_code.be4e9f421c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stock_code\nfrom RETAIL_DW.STAGING_analytics.dim_products\nwhere stock_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.451583Z", "completed_at": "2026-01-11T14:28:18.459555Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.467215Z", "completed_at": "2026-01-11T14:28:18.467215Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027186155319213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_dim_products_total_revenue.07243f7e3a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue\nfrom RETAIL_DW.STAGING_analytics.dim_products\nwhere total_revenue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.459555Z", "completed_at": "2026-01-11T14:28:18.459555Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.469237Z", "completed_at": "2026-01-11T14:28:18.469237Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02920842170715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.unique_dim_products_product_key.5837b56652", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_key as unique_field,\n    count(*) as n_records\n\nfrom RETAIL_DW.STAGING_analytics.dim_products\nwhere product_key is not null\ngroup by product_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.469747Z", "completed_at": "2026-01-11T14:28:18.478175Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.483837Z", "completed_at": "2026-01-11T14:28:18.483837Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024282217025756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.unique_dim_products_stock_code.249bcf00aa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stock_code as unique_field,\n    count(*) as n_records\n\nfrom RETAIL_DW.STAGING_analytics.dim_products\nwhere stock_code is not null\ngroup by stock_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.480186Z", "completed_at": "2026-01-11T14:28:18.490536Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.497488Z", "completed_at": "2026-01-11T14:28:18.497488Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022636890411376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_fact_sales_customer_key.c5a1d049ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_key\nfrom RETAIL_DW.STAGING_analytics.fact_sales\nwhere customer_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.483837Z", "completed_at": "2026-01-11T14:28:18.497488Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.500706Z", "completed_at": "2026-01-11T14:28:18.500706Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024843215942382812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_fact_sales_line_total.9d5cf64608", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect line_total\nfrom RETAIL_DW.STAGING_analytics.fact_sales\nwhere line_total is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.490536Z", "completed_at": "2026-01-11T14:28:18.499169Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.500706Z", "completed_at": "2026-01-11T14:28:18.500706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024843215942382812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_fact_sales_product_key.e4fd332b98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_key\nfrom RETAIL_DW.STAGING_analytics.fact_sales\nwhere product_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.500706Z", "completed_at": "2026-01-11T14:28:18.500706Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.513117Z", "completed_at": "2026-01-11T14:28:18.513117Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022580862045288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.not_null_fact_sales_sales_key.2e48edf530", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_key\nfrom RETAIL_DW.STAGING_analytics.fact_sales\nwhere sales_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.513117Z", "completed_at": "2026-01-11T14:28:18.531818Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.531818Z", "completed_at": "2026-01-11T14:28:18.531818Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0311124324798584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.relationships_fact_sales_customer_key__customer_key__ref_dim_customers_.0902d0ddb5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_key as from_field\n    from RETAIL_DW.STAGING_analytics.fact_sales\n    where customer_key is not null\n),\n\nparent as (\n    select customer_key as to_field\n    from RETAIL_DW.STAGING_analytics.dim_customers\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.521246Z", "completed_at": "2026-01-11T14:28:18.531818Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.531818Z", "completed_at": "2026-01-11T14:28:18.531818Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0311124324798584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.relationships_fact_sales_product_key__product_key__ref_dim_products_.43a302dbdf", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_key as from_field\n    from RETAIL_DW.STAGING_analytics.fact_sales\n    where product_key is not null\n),\n\nparent as (\n    select product_key as to_field\n    from RETAIL_DW.STAGING_analytics.dim_products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-11T14:28:18.525544Z", "completed_at": "2026-01-11T14:28:18.531818Z"}, {"name": "execute", "started_at": "2026-01-11T14:28:18.531818Z", "completed_at": "2026-01-11T14:28:18.531818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020890474319458008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.retail_analytics.unique_fact_sales_sales_key.40fae2a4c6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sales_key as unique_field,\n    count(*) as n_records\n\nfrom RETAIL_DW.STAGING_analytics.fact_sales\nwhere sales_key is not null\ngroup by sales_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 1.5670793056488037, "args": {"empty_catalog": false, "vars": {}, "indirect_selection": "eager", "exclude": [], "require_batched_execution_for_custom_microbatch_strategy": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_unique_project_resource_names": false, "require_generic_test_arguments_property": true, "upload_to_artifacts_ingest_api": false, "validate_macro_args": false, "show_resource_report": false, "select": [], "source_freshness_run_project_hooks": true, "version_check": true, "populate_cache": true, "require_nested_cumulative_type_params": false, "invocation_command": "dbt docs generate", "project_dir": "C:\\Users\\kloug\\retail_pipeline\\dbt_project", "use_fast_test_edges": false, "partial_parse_file_diff": true, "log_path": "C:\\Users\\kloug\\retail_pipeline\\dbt_project\\logs", "quiet": false, "compile": true, "introspect": true, "strict_mode": false, "use_colors": true, "macro_debugging": false, "printer_width": 80, "log_format": "default", "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "favor_state": false, "skip_nodes_if_on_run_start_fails": false, "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": true, "profiles_dir": "C:\\Users\\kloug\\retail_pipeline\\dbt_project", "require_all_warnings_handled_by_warn_error": false, "use_colors_file": true, "log_format_file": "debug", "show_all_deprecations": false, "cache_selected_only": false, "require_yaml_configuration_for_mf_time_spines": false, "static": false, "write_json": true, "defer": false, "state_modified_compare_more_unrendered_values": false, "static_parser": true, "partial_parse": true, "print": true, "require_ref_searches_node_package_before_root": false, "state_modified_compare_vars": false, "which": "generate", "log_level_file": "debug"}}